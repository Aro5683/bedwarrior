<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EduWarrior Premium</title>

<style>
body{
  margin:0;
  font-family:'Segoe UI',sans-serif;
  background: radial-gradient(circle at top,#0f172a,#020617);
  color:#fff;
}
.container{
  max-width:1200px;
  margin:auto;
  padding:50px 20px;
  text-align:center;
}
h1{font-size:40px;}
h1 span{color:#f59e0b;}
.subtitle{opacity:.7;margin-bottom:40px;}
.pricing{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap:25px;
}
.card{
  background:rgba(255,255,255,.05);
  backdrop-filter:blur(15px);
  border-radius:20px;
  padding:25px;
  width:270px;
  box-shadow:0 0 30px rgba(0,0,0,.5);
  transition:.3s;
}
.card:hover{transform:translateY(-6px);}
.popular{border:2px solid #f59e0b;}
.price{
  font-size:34px;
  margin:15px 0;
  color:#f59e0b;
}
ul{
  list-style:none;
  padding:0;
  text-align:left;
  margin:15px 0;
}
ul li{margin:8px 0;opacity:.8;}
button{
  width:100%;
  padding:12px;
  margin-top:10px;
  border:none;
  border-radius:10px;
  font-weight:bold;
  cursor:pointer;
}
.buyBtn{
  background:linear-gradient(90deg,#f59e0b,#fbbf24);
  color:#000;
}
.payBtn{
  background:#16a34a;
  color:#fff;
}
.whatsappBtn{
  background:#25D366;
  color:#fff;
}
.downloadBtn{
  background:#2563eb;
  color:#fff;
}
input{
  width:100%;
  padding:10px;
  margin:6px 0;
  border-radius:8px;
  border:none;
  background:#111827;
  color:#fff;
}
.section{
  margin-top:60px;
  max-width:500px;
  margin-left:auto;
  margin-right:auto;
  background:rgba(255,255,255,.05);
  padding:25px;
  border-radius:15px;
}
footer{
  margin-top:60px;
  opacity:.5;
}
@media(max-width:768px){
  .pricing{flex-direction:column;align-items:center;}
}
</style>
</head>
<body>

<div class="container">

<h1>Premium B.Ed <span>Study Packages</span></h1>
<p class="subtitle">Secure • Device Bound • Encrypted</p>

<div class="pricing">

  <div class="card">
    <h3>Basic</h3>
    <div class="price">₹129</div>
    <ul>
      <li>✔ B.Ed Notes</li>
      <li>✔ Important Questions</li>
      <li>✔ Mobile Friendly</li>
    </ul>
    <button class="buyBtn" onclick="selectPackage('Basic',129)">Select</button>
  </div>

  <div class="card">
    <h3>Standard</h3>
    <div class="price">₹139</div>
    <ul>
      <li>✔ Notes</li>
      <li>✔ Circulars</li>
      <li>✔ Important Questions</li>
      <li>✔ Mobile Friendly</li>
    </ul>
    <button class="buyBtn" onclick="selectPackage('Standard',139)">Select</button>
  </div>

  <div class="card popular">
    <h3>Premium</h3>
    <div class="price">₹149</div>
    <ul>
      <li>✔ Notes</li>
      <li>✔ Circulars</li>
      <li>✔ Model Papers</li>
      <li>✔ Important Questions</li>
      <li>✔ Mobile Friendly</li>
    </ul>
    <button class="buyBtn" onclick="selectPackage('Premium',149)">Select</button>
  </div>

  <div class="card">
    <h3>Ultimate</h3>
    <div class="price">₹159</div>
    <ul>
      <li>✔ All Features</li>
      <li>✔ Bonus Materials</li>
      <li>✔ Future Updates</li>
      <li>✔ Priority Support</li>
    </ul>
    <button class="buyBtn" onclick="selectPackage('Ultimate',159)">Select</button>
  </div>

</div>

<!-- PURCHASE SECTION -->
<div class="section">

<h3>Complete Your Purchase</h3>

<input type="text" id="name" placeholder="Enter Full Name">
<input type="text" id="phone" placeholder="Enter Phone Number">

<p id="selectedInfo"></p>

<button class="payBtn" onclick="payUPI()">Pay via UPI</button>
<button class="whatsappBtn" onclick="openWhatsApp()">Send Details in WhatsApp</button>
<button class="downloadBtn" onclick="downloadBedx()">Download .bedx</button>

<p id="codeDisplay"></p>

</div>
<hr style="margin:30px 0;opacity:.3">

<h3>Open Purchased Book</h3>

<input type="file" id="openFileInput">
<button class="buyBtn" onclick="openBook()">Open Book</button>

<div id="alertBox"></div>
<div id="viewer"></div>

<footer>
© 2025 EduWarrior Premium
</footer>

</div>

<script>
let selectedPackage="";
let selectedAmount=0;
let generatedCode="";

function selectPackage(name, amount){
  selectedPackage=name;
  selectedAmount=amount;
  document.getElementById("selectedInfo").innerText=
  "Selected: "+name+" - ₹"+amount;
}

function generateCode(){
  let c="";
  for(let i=0;i<16;i++){c+=Math.floor(Math.random()*10);}
  return c;
}

function payUPI(){
  if(!selectedPackage){alert("Select package first");return;}
  const upi="upi://pay?pa=9629981854@paytm&pn=EduWarrior&am="+selectedAmount+"&cu=INR";
  window.location.href=upi;
}

function openWhatsApp(){
  const name=document.getElementById("name").value;
  const phone=document.getElementById("phone").value;

  if(!name||!phone||!selectedPackage){
    alert("Fill details & select package");
    return;
  }

  if(!generatedCode){
    generatedCode=generateCode();
    document.getElementById("codeDisplay").innerHTML=
    "<br>Your Code: <b>"+generatedCode+"</b><br>After payment, send this code.";
  }

  const message=
`Hello Admin,
Name: ${name}
Phone: ${phone}
Package: ${selectedPackage}
Amount: ₹${selectedAmount}
Code: ${generatedCode}
I have paid via UPI.`;

  window.open(
  "https://wa.me/91YOURNUMBER?text="+encodeURIComponent(message),
  "_blank");
}

async function downloadBedx(){

  if(!generatedCode){
    alert("Generate code first (Click WhatsApp button)");
    return;
  }

  const name=document.getElementById("name").value;
  const phone=document.getElementById("phone").value;

  const deviceID=btoa(navigator.userAgent+screen.width);

  const master=await fetch("master.bedx").then(r=>r.text());
  const m=JSON.parse(master);

  const keyMaterial=await crypto.subtle.digest(
    "SHA-256",
    new TextEncoder().encode(generatedCode+deviceID)
  );

  const key=await crypto.subtle.importKey(
    "raw",
    keyMaterial,
    {name:"AES-GCM"},
    false,
    ["encrypt"]
  );

  const iv=crypto.getRandomValues(new Uint8Array(12));

  const encrypted=await crypto.subtle.encrypt(
    {name:"AES-GCM",iv},
    key,
    new Uint8Array(m.data)
  );

  const fileData={
    iv:Array.from(iv),
    data:Array.from(new Uint8Array(encrypted)),
    code:generatedCode,
    deviceID,
    name,
    phone,
    package:selectedPackage
  };

  const blob=new Blob([JSON.stringify(fileData)]);
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="BEd_"+generatedCode+".bedx";
  a.click();
}

  async function openBook(){

  const alertBox=document.getElementById("alertBox");
  alertBox.innerText="";

  const file=document.getElementById("openFileInput").files[0];
  if(!file){
    alertBox.innerText="Select your .bedx file.";
    return;
  }

  const json=JSON.parse(await file.text());

  const deviceID=btoa(navigator.userAgent+screen.width);

  if(json.deviceID!==deviceID){
    alertBox.innerText="This file is not for this device.";
    return;
  }

  const codes=await fetch("codes.json").then(r=>r.json());
  const found=codes.find(c=>c.code.trim()===json.code.trim());

  if(!found||!found.approved){
    alertBox.innerText="Payment not approved yet.";
    return;
  }

  const keyMaterial=await crypto.subtle.digest(
    "SHA-256",
    new TextEncoder().encode(json.code+json.deviceID)
  );

  const key=await crypto.subtle.importKey(
    "raw",
    keyMaterial,
    {name:"AES-GCM"},
    false,
    ["decrypt"]
  );

  try{

    const decrypted=await crypto.subtle.decrypt(
      {name:"AES-GCM",iv:new Uint8Array(json.iv)},
      key,
      new Uint8Array(json.data)
    );

    const blob=new Blob([decrypted],{type:"application/pdf"});
    const url=URL.createObjectURL(blob);

    document.getElementById("viewer").innerHTML=
      `<iframe src="${url}" width="100%" height="600px"></iframe>`;

  }catch{
    alertBox.innerText="Cannot open this file.";
  }
}

</script>

</body>
</html>
